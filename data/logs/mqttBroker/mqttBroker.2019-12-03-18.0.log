2019-12-03 18:00:56.159 [worker-5-1] c.z.m.p.MqttServerPingReqProcess:39   DEBUG - PINGREQ - clientId: jimmy170503941
2019-12-03 18:01:27.653 [main] o.s.boot.StartupInfoLogger:50   INFO  - Starting Bootstarp on jimmydeMacBook-Pro.local with PID 1848 (/Users/jimmy/IdeaProjects/huzwj/mqttBroker/cloud-mqttBroker/target/classes started by jimmy in /Users/jimmy/IdeaProjects/huzwj/mqttBroker)
2019-12-03 18:01:27.655 [main] o.s.boot.StartupInfoLogger:53   DEBUG - Running with Spring Boot v2.0.7.RELEASE, Spring v5.0.11.RELEASE
2019-12-03 18:01:27.656 [main] o.s.boot.SpringApplication:654  INFO  - No active profile set, falling back to default profiles: default
2019-12-03 18:01:28.882 [main] o.s.boot.StartupInfoLogger:59   INFO  - Started Bootstarp in 1.443 seconds (JVM running for 2.007)
2019-12-03 18:01:28.885 [main] com.zwj.mqtt.server.MqttServer:55   INFO  - starting mqtt broker: 2 
2019-12-03 18:01:28.969 [main] com.zwj.mqtt.server.MqttServer:93   INFO  - started mqtt broker: 2 ,host:127.0.0.1, port: 8070
2019-12-03 18:01:42.636 [main] o.s.boot.StartupInfoLogger:50   INFO  - Starting Bootstarp on jimmydeMacBook-Pro.local with PID 1851 (/Users/jimmy/IdeaProjects/huzwj/mqttBroker/cloud-mqttBroker/target/classes started by jimmy in /Users/jimmy/IdeaProjects/huzwj/mqttBroker)
2019-12-03 18:01:42.638 [main] o.s.boot.StartupInfoLogger:53   DEBUG - Running with Spring Boot v2.0.7.RELEASE, Spring v5.0.11.RELEASE
2019-12-03 18:01:42.639 [main] o.s.boot.SpringApplication:654  INFO  - No active profile set, falling back to default profiles: default
2019-12-03 18:01:43.851 [main] o.s.boot.StartupInfoLogger:59   INFO  - Started Bootstarp in 1.428 seconds (JVM running for 1.988)
2019-12-03 18:01:43.854 [main] com.zwj.mqtt.server.MqttServer:55   INFO  - starting mqtt broker: 1 
2019-12-03 18:01:43.990 [main] com.zwj.mqtt.server.MqttServer:93   INFO  - started mqtt broker: 1 ,host:127.0.0.1, port: 9090
2019-12-03 18:01:50.473 [worker-5-1] c.z.m.s.impl.SessionServiceImpl:47   DEBUG - putSessionByClient,clientId:jimmy170503941,sessionModel:{"brokerId":1,"clientId":"jimmy170503941","channelId":"acde48fffe001122-0000073b-00000001-0b6355048efd78fb-997c7f55","cleanSession":true,"willMessage":{"payload":"d2lsbCBtZXNzYWdlAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\u003d\u003d","messageType":3,"isDup":false,"qosLevel":0,"isRetain":false,"remainingLength":0,"topicName":"111","packetId":0,"hasWillMessage":true}},mexpire:{}
2019-12-03 18:01:50.517 [worker-5-1] c.z.m.p.MqttServerConnectProcess:146  DEBUG - CONNECT - clientId: jimmy170503941, connectMsg: MqttConnectMessage[fixedHeader=MqttFixedHeader[messageType=CONNECT, isDup=false, qosLevel=AT_MOST_ONCE, isRetain=false, remainingLength=45], variableHeader=MqttConnectVariableHeader[name=MQTT, version=4, hasUserName=false, hasPassword=false, isWillRetain=false, isWillFlag=true, isCleanSession=true, keepAliveTimeSeconds=60], payload=MqttConnectPayload[clientIdentifier=jimmy170503941, willTopic=111, willMessage=[B@1298573e, userName=null, password=null]],connectAckMsg:MqttConnAckMessage[fixedHeader=MqttFixedHeader[messageType=CONNACK, isDup=false, qosLevel=AT_MOST_ONCE, isRetain=false, remainingLength=0], variableHeader=MqttConnAckVariableHeader[connectReturnCode=CONNECTION_ACCEPTED, sessionPresent=false], payload=]
2019-12-03 18:01:55.682 [worker-5-1] c.z.m.s.impl.SessionServiceImpl:47   DEBUG - putSessionByClient,clientId:jimmy172320146,sessionModel:{"brokerId":2,"clientId":"jimmy172320146","channelId":"acde48fffe001122-00000738-00000001-02de4fdf0efd8d61-a1f537c1","cleanSession":true,"willMessage":null},mexpire:{}
2019-12-03 18:01:55.727 [worker-5-1] c.z.m.p.MqttServerConnectProcess:146  DEBUG - CONNECT - clientId: jimmy172320146, connectMsg: MqttConnectMessage[fixedHeader=MqttFixedHeader[messageType=CONNECT, isDup=false, qosLevel=AT_MOST_ONCE, isRetain=false, remainingLength=26], variableHeader=MqttConnectVariableHeader[name=MQTT, version=4, hasUserName=false, hasPassword=false, isWillRetain=false, isWillFlag=false, isCleanSession=true, keepAliveTimeSeconds=60], payload=MqttConnectPayload[clientIdentifier=jimmy172320146, willTopic=null, willMessage=null, userName=null, password=null]],connectAckMsg:MqttConnAckMessage[fixedHeader=MqttFixedHeader[messageType=CONNACK, isDup=false, qosLevel=AT_MOST_ONCE, isRetain=false, remainingLength=0], variableHeader=MqttConnAckVariableHeader[connectReturnCode=CONNECTION_ACCEPTED, sessionPresent=false], payload=]
2019-12-03 18:01:59.763 [worker-5-1] c.z.m.p.MqttServerSubscribeProcess:58   DEBUG - subscribe - clientId: jimmy172320146,msg:MqttSubscribeMessage[fixedHeader=MqttFixedHeader[messageType=SUBSCRIBE, isDup=false, qosLevel=AT_LEAST_ONCE, isRetain=false, remainingLength=10], variableHeader=MqttMessageIdVariableHeader[messageId=1], payload=MqttSubscribePayload[MqttTopicSubscription[topicFilter=80701, qualityOfService=AT_MOST_ONCE]]]
2019-12-03 18:01:59.844 [worker-5-1] c.z.m.p.MqttServerSubscribeProcess:70   DEBUG - SUBSCRIBE - clientId: jimmy172320146, topFilter: 80701, QoS: 0
2019-12-03 18:02:19.616 [worker-5-1] c.z.m.s.impl.SessionServiceImpl:36   DEBUG - getSessionByClientId,clientId:jimmy170503941,result:{"brokerId":1,"clientId":"jimmy170503941","channelId":"acde48fffe001122-0000073b-00000001-0b6355048efd78fb-997c7f55","cleanSession":true,"willMessage":{"payload":"d2lsbCBtZXNzYWdlAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\u003d\u003d","messageType":3,"isDup":false,"qosLevel":0,"isRetain":false,"remainingLength":0,"topicName":"111","packetId":0,"hasWillMessage":true}}
2019-12-03 18:02:19.619 [worker-5-1] c.z.m.p.MqttServerPublishProcess:122  DEBUG - Publish - clientId: jimmy170503941, cleanSession: MqttPublishMessage[fixedHeader=MqttFixedHeader[messageType=PUBLISH, isDup=false, qosLevel=AT_MOST_ONCE, isRetain=false, remainingLength=14], variableHeader=MqttPublishVariableHeader[topicName=80701, packetId=-1], payload=PooledSlicedByteBuf(ridx: 0, widx: 7, cap: 7/7, unwrapped: PooledUnsafeDirectByteBuf(ridx: 16, widx: 16, cap: 1024))]
2019-12-03 18:02:20.099 [kafka-producer-network-thread | producer-1] com.zwj.mqtt.cluster.Producer$1:30   DEBUG - kafka topic [hubMqttCluster]  message [{"clientId":"jimmy172320146","retain":false,"dup":false,"topic":"80701","mqttQoS":0,"payload":"AAAAAAAAAA\u003d\u003d"}]  send, resultProducerRecord(topic=hubMqttCluster, partition=null, headers=RecordHeaders(headers = [], isReadOnly = true), key=null, value={"clientId":"jimmy172320146","retain":false,"dup":false,"topic":"80701","mqttQoS":0,"payload":"AAAAAAAAAA\u003d\u003d"}, timestamp=null)
2019-12-03 18:02:20.119 [org.springframework.kafka.KafkaListenerEndpointContainer#0-13-C-1] com.zwj.mqtt.cluster.Consumer:31   DEBUG - revice kafka message:{"clientId":"jimmy172320146","retain":false,"dup":false,"topic":"80701","mqttQoS":0,"payload":"AAAAAAAAAA\u003d\u003d"}
2019-12-03 18:02:20.164 [org.springframework.kafka.KafkaListenerEndpointContainer#0-13-C-1] com.zwj.mqtt.cluster.Consumer:31   DEBUG - revice kafka message:{"clientId":"jimmy172320146","retain":false,"dup":false,"topic":"80701","mqttQoS":0,"payload":"AAAAAAAAAA\u003d\u003d"}
2019-12-03 18:02:50.521 [worker-5-1] c.z.m.p.MqttServerPingReqProcess:39   DEBUG - PINGREQ - clientId: jimmy170503941
2019-12-03 18:02:59.767 [worker-5-1] c.z.m.p.MqttServerPingReqProcess:39   DEBUG - PINGREQ - clientId: jimmy172320146
2019-12-03 18:03:50.524 [worker-5-1] c.z.m.p.MqttServerPingReqProcess:39   DEBUG - PINGREQ - clientId: jimmy170503941
2019-12-03 18:03:59.771 [worker-5-1] c.z.m.p.MqttServerPingReqProcess:39   DEBUG - PINGREQ - clientId: jimmy172320146
2019-12-03 18:04:50.529 [worker-5-1] c.z.m.p.MqttServerPingReqProcess:39   DEBUG - PINGREQ - clientId: jimmy170503941
2019-12-03 18:04:59.776 [worker-5-1] c.z.m.p.MqttServerPingReqProcess:39   DEBUG - PINGREQ - clientId: jimmy172320146
2019-12-03 18:05:36.248 [main] o.s.boot.StartupInfoLogger:50   INFO  - Starting Bootstarp on jimmydeMacBook-Pro.local with PID 1858 (/Users/jimmy/IdeaProjects/huzwj/mqttBroker/cloud-mqttBroker/target/classes started by jimmy in /Users/jimmy/IdeaProjects/huzwj/mqttBroker)
2019-12-03 18:05:36.251 [main] o.s.boot.StartupInfoLogger:53   DEBUG - Running with Spring Boot v2.0.7.RELEASE, Spring v5.0.11.RELEASE
2019-12-03 18:05:36.251 [main] o.s.boot.SpringApplication:654  INFO  - No active profile set, falling back to default profiles: default
2019-12-03 18:05:37.459 [main] o.s.boot.StartupInfoLogger:59   INFO  - Started Bootstarp in 1.428 seconds (JVM running for 1.978)
2019-12-03 18:05:37.462 [main] com.zwj.mqtt.server.MqttServer:55   INFO  - starting mqtt broker: 1 
2019-12-03 18:05:37.597 [main] com.zwj.mqtt.server.MqttServer:93   INFO  - started mqtt broker: 1 ,host:127.0.0.1, port: 9090
2019-12-03 18:05:49.585 [main] o.s.boot.StartupInfoLogger:50   INFO  - Starting Bootstarp on jimmydeMacBook-Pro.local with PID 1865 (/Users/jimmy/IdeaProjects/huzwj/mqttBroker/cloud-mqttBroker/target/classes started by jimmy in /Users/jimmy/IdeaProjects/huzwj/mqttBroker)
2019-12-03 18:05:49.588 [main] o.s.boot.StartupInfoLogger:53   DEBUG - Running with Spring Boot v2.0.7.RELEASE, Spring v5.0.11.RELEASE
2019-12-03 18:05:49.589 [main] o.s.boot.SpringApplication:654  INFO  - No active profile set, falling back to default profiles: default
2019-12-03 18:05:50.713 [main] o.s.boot.StartupInfoLogger:59   INFO  - Started Bootstarp in 1.342 seconds (JVM running for 1.9)
2019-12-03 18:05:50.716 [main] com.zwj.mqtt.server.MqttServer:55   INFO  - starting mqtt broker: 2 
2019-12-03 18:05:50.830 [main] com.zwj.mqtt.server.MqttServer:93   INFO  - started mqtt broker: 2 ,host:127.0.0.1, port: 8070
2019-12-03 18:06:03.044 [worker-5-1] c.z.m.s.impl.SessionServiceImpl:47   DEBUG - putSessionByClient,clientId:jimmy172320146,sessionModel:{"brokerId":2,"clientId":"jimmy172320146","channelId":"acde48fffe001122-00000749-00000001-f0a2726a70f15358-10f276cc","cleanSession":true,"willMessage":null},mexpire:{}
2019-12-03 18:06:03.093 [worker-5-1] c.z.m.p.MqttServerConnectProcess:146  DEBUG - CONNECT - clientId: jimmy172320146, connectMsg: MqttConnectMessage[fixedHeader=MqttFixedHeader[messageType=CONNECT, isDup=false, qosLevel=AT_MOST_ONCE, isRetain=false, remainingLength=26], variableHeader=MqttConnectVariableHeader[name=MQTT, version=4, hasUserName=false, hasPassword=false, isWillRetain=false, isWillFlag=false, isCleanSession=true, keepAliveTimeSeconds=60], payload=MqttConnectPayload[clientIdentifier=jimmy172320146, willTopic=null, willMessage=null, userName=null, password=null]],connectAckMsg:MqttConnAckMessage[fixedHeader=MqttFixedHeader[messageType=CONNACK, isDup=false, qosLevel=AT_MOST_ONCE, isRetain=false, remainingLength=0], variableHeader=MqttConnAckVariableHeader[connectReturnCode=CONNECTION_ACCEPTED, sessionPresent=false], payload=]
2019-12-03 18:06:05.718 [worker-5-1] c.z.m.s.impl.SessionServiceImpl:47   DEBUG - putSessionByClient,clientId:jimmy170503941,sessionModel:{"brokerId":1,"clientId":"jimmy170503941","channelId":"acde48fffe001122-00000742-00000001-2371706d70f15dd0-96890491","cleanSession":true,"willMessage":{"payload":"d2lsbCBtZXNzYWdlAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\u003d\u003d","messageType":3,"isDup":false,"qosLevel":0,"isRetain":false,"remainingLength":0,"topicName":"111","packetId":0,"hasWillMessage":true}},mexpire:{}
2019-12-03 18:06:05.763 [worker-5-1] c.z.m.p.MqttServerConnectProcess:146  DEBUG - CONNECT - clientId: jimmy170503941, connectMsg: MqttConnectMessage[fixedHeader=MqttFixedHeader[messageType=CONNECT, isDup=false, qosLevel=AT_MOST_ONCE, isRetain=false, remainingLength=45], variableHeader=MqttConnectVariableHeader[name=MQTT, version=4, hasUserName=false, hasPassword=false, isWillRetain=false, isWillFlag=true, isCleanSession=true, keepAliveTimeSeconds=60], payload=MqttConnectPayload[clientIdentifier=jimmy170503941, willTopic=111, willMessage=[B@2a4fac7f, userName=null, password=null]],connectAckMsg:MqttConnAckMessage[fixedHeader=MqttFixedHeader[messageType=CONNACK, isDup=false, qosLevel=AT_MOST_ONCE, isRetain=false, remainingLength=0], variableHeader=MqttConnAckVariableHeader[connectReturnCode=CONNECTION_ACCEPTED, sessionPresent=false], payload=]
2019-12-03 18:06:08.538 [worker-5-1] c.z.m.s.impl.SessionServiceImpl:36   DEBUG - getSessionByClientId,clientId:jimmy170503941,result:{"brokerId":1,"clientId":"jimmy170503941","channelId":"acde48fffe001122-00000742-00000001-2371706d70f15dd0-96890491","cleanSession":true,"willMessage":{"payload":"d2lsbCBtZXNzYWdlAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\u003d\u003d","messageType":3,"isDup":false,"qosLevel":0,"isRetain":false,"remainingLength":0,"topicName":"111","packetId":0,"hasWillMessage":true}}
2019-12-03 18:06:08.541 [worker-5-1] c.z.m.p.MqttServerPublishProcess:122  DEBUG - Publish - clientId: jimmy170503941, cleanSession: MqttPublishMessage[fixedHeader=MqttFixedHeader[messageType=PUBLISH, isDup=false, qosLevel=AT_MOST_ONCE, isRetain=false, remainingLength=14], variableHeader=MqttPublishVariableHeader[topicName=80701, packetId=-1], payload=PooledSlicedByteBuf(ridx: 0, widx: 7, cap: 7/7, unwrapped: PooledUnsafeDirectByteBuf(ridx: 16, widx: 16, cap: 1024))]
2019-12-03 18:06:22.640 [worker-5-1] c.z.m.s.impl.SessionServiceImpl:36   DEBUG - getSessionByClientId,clientId:jimmy170503941,result:{"brokerId":1,"clientId":"jimmy170503941","channelId":"acde48fffe001122-00000742-00000001-2371706d70f15dd0-96890491","cleanSession":true,"willMessage":{"payload":"d2lsbCBtZXNzYWdlAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\u003d\u003d","messageType":3,"isDup":false,"qosLevel":0,"isRetain":false,"remainingLength":0,"topicName":"111","packetId":0,"hasWillMessage":true}}
2019-12-03 18:06:22.641 [worker-5-1] c.z.m.p.MqttServerPublishProcess:122  DEBUG - Publish - clientId: jimmy170503941, cleanSession: MqttPublishMessage[fixedHeader=MqttFixedHeader[messageType=PUBLISH, isDup=false, qosLevel=AT_MOST_ONCE, isRetain=false, remainingLength=14], variableHeader=MqttPublishVariableHeader[topicName=80701, packetId=-1], payload=PooledSlicedByteBuf(ridx: 0, widx: 7, cap: 7/7, unwrapped: PooledUnsafeDirectByteBuf(ridx: 16, widx: 16, cap: 512))]
2019-12-03 18:06:27.423 [worker-5-1] c.z.m.p.MqttServerSubscribeProcess:58   DEBUG - subscribe - clientId: jimmy172320146,msg:MqttSubscribeMessage[fixedHeader=MqttFixedHeader[messageType=SUBSCRIBE, isDup=false, qosLevel=AT_LEAST_ONCE, isRetain=false, remainingLength=11], variableHeader=MqttMessageIdVariableHeader[messageId=1], payload=MqttSubscribePayload[MqttTopicSubscription[topicFilter=807012, qualityOfService=AT_MOST_ONCE]]]
2019-12-03 18:06:27.504 [worker-5-1] c.z.m.p.MqttServerSubscribeProcess:70   DEBUG - SUBSCRIBE - clientId: jimmy172320146, topFilter: 807012, QoS: 0
2019-12-03 18:06:30.042 [worker-5-1] c.z.m.s.impl.SessionServiceImpl:36   DEBUG - getSessionByClientId,clientId:jimmy170503941,result:{"brokerId":1,"clientId":"jimmy170503941","channelId":"acde48fffe001122-00000742-00000001-2371706d70f15dd0-96890491","cleanSession":true,"willMessage":{"payload":"d2lsbCBtZXNzYWdlAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\u003d\u003d","messageType":3,"isDup":false,"qosLevel":0,"isRetain":false,"remainingLength":0,"topicName":"111","packetId":0,"hasWillMessage":true}}
2019-12-03 18:06:30.043 [worker-5-1] c.z.m.p.MqttServerPublishProcess:122  DEBUG - Publish - clientId: jimmy170503941, cleanSession: MqttPublishMessage[fixedHeader=MqttFixedHeader[messageType=PUBLISH, isDup=false, qosLevel=AT_MOST_ONCE, isRetain=false, remainingLength=15], variableHeader=MqttPublishVariableHeader[topicName=807012, packetId=-1], payload=PooledSlicedByteBuf(ridx: 0, widx: 7, cap: 7/7, unwrapped: PooledUnsafeDirectByteBuf(ridx: 17, widx: 17, cap: 512))]
2019-12-03 18:06:30.364 [kafka-producer-network-thread | producer-1] com.zwj.mqtt.cluster.Producer$1:30   DEBUG - kafka topic [hubMqttCluster]  message [{"clientId":"jimmy172320146","retain":false,"dup":false,"topic":"807012","mqttQoS":0,"payload":"AAAAAAAAAA\u003d\u003d"}]  send, resultProducerRecord(topic=hubMqttCluster, partition=null, headers=RecordHeaders(headers = [], isReadOnly = true), key=null, value={"clientId":"jimmy172320146","retain":false,"dup":false,"topic":"807012","mqttQoS":0,"payload":"AAAAAAAAAA\u003d\u003d"}, timestamp=null)
2019-12-03 18:06:30.423 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] com.zwj.mqtt.cluster.Consumer:31   DEBUG - revice kafka message:{"clientId":"jimmy172320146","retain":false,"dup":false,"topic":"807012","mqttQoS":0,"payload":"AAAAAAAAAA\u003d\u003d"}
2019-12-03 18:06:30.426 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] c.z.m.p.MqttServerPublishProcess:190  DEBUG - PUBLISH - clientId: jimmy172320146, topic: 807012, Qos: 0
2019-12-03 18:06:30.450 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] com.zwj.mqtt.cluster.Consumer:31   DEBUG - revice kafka message:{"clientId":"jimmy172320146","retain":false,"dup":false,"topic":"807012","mqttQoS":0,"payload":"AAAAAAAAAA\u003d\u003d"}
2019-12-03 18:07:05.768 [worker-5-1] c.z.m.p.MqttServerPingReqProcess:39   DEBUG - PINGREQ - clientId: jimmy170503941
2019-12-03 18:07:22.962 [worker-5-1] c.z.m.s.impl.SessionServiceImpl:36   DEBUG - getSessionByClientId,clientId:jimmy170503941,result:{"brokerId":1,"clientId":"jimmy170503941","channelId":"acde48fffe001122-00000742-00000001-2371706d70f15dd0-96890491","cleanSession":true,"willMessage":{"payload":"d2lsbCBtZXNzYWdlAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\u003d\u003d","messageType":3,"isDup":false,"qosLevel":0,"isRetain":false,"remainingLength":0,"topicName":"111","packetId":0,"hasWillMessage":true}}
2019-12-03 18:07:22.963 [worker-5-1] c.z.m.p.MqttServerPublishProcess:122  DEBUG - Publish - clientId: jimmy170503941, cleanSession: MqttPublishMessage[fixedHeader=MqttFixedHeader[messageType=PUBLISH, isDup=false, qosLevel=AT_MOST_ONCE, isRetain=false, remainingLength=16], variableHeader=MqttPublishVariableHeader[topicName=807012, packetId=-1], payload=PooledSlicedByteBuf(ridx: 0, widx: 8, cap: 8/8, unwrapped: PooledUnsafeDirectByteBuf(ridx: 18, widx: 18, cap: 496))]
2019-12-03 18:07:23.051 [kafka-producer-network-thread | producer-1] com.zwj.mqtt.cluster.Producer$1:30   DEBUG - kafka topic [hubMqttCluster]  message [{"clientId":"jimmy172320146","retain":false,"dup":false,"topic":"807012","mqttQoS":0,"payload":"AAAAAAAAAAA\u003d"}]  send, resultProducerRecord(topic=hubMqttCluster, partition=null, headers=RecordHeaders(headers = [], isReadOnly = true), key=null, value={"clientId":"jimmy172320146","retain":false,"dup":false,"topic":"807012","mqttQoS":0,"payload":"AAAAAAAAAAA\u003d"}, timestamp=null)
2019-12-03 18:07:23.148 [org.springframework.kafka.KafkaListenerEndpointContainer#0-11-C-1] com.zwj.mqtt.cluster.Consumer:31   DEBUG - revice kafka message:{"clientId":"jimmy172320146","retain":false,"dup":false,"topic":"807012","mqttQoS":0,"payload":"AAAAAAAAAAA\u003d"}
2019-12-03 18:07:23.183 [org.springframework.kafka.KafkaListenerEndpointContainer#0-11-C-1] com.zwj.mqtt.cluster.Consumer:31   DEBUG - revice kafka message:{"clientId":"jimmy172320146","retain":false,"dup":false,"topic":"807012","mqttQoS":0,"payload":"AAAAAAAAAAA\u003d"}
2019-12-03 18:07:23.184 [org.springframework.kafka.KafkaListenerEndpointContainer#0-11-C-1] c.z.m.p.MqttServerPublishProcess:190  DEBUG - PUBLISH - clientId: jimmy172320146, topic: 807012, Qos: 0
2019-12-03 18:07:27.427 [worker-5-1] c.z.m.p.MqttServerPingReqProcess:39   DEBUG - PINGREQ - clientId: jimmy172320146
2019-12-03 18:07:34.731 [worker-5-1] c.z.m.s.impl.SessionServiceImpl:36   DEBUG - getSessionByClientId,clientId:jimmy170503941,result:{"brokerId":1,"clientId":"jimmy170503941","channelId":"acde48fffe001122-00000742-00000001-2371706d70f15dd0-96890491","cleanSession":true,"willMessage":{"payload":"d2lsbCBtZXNzYWdlAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\u003d\u003d","messageType":3,"isDup":false,"qosLevel":0,"isRetain":false,"remainingLength":0,"topicName":"111","packetId":0,"hasWillMessage":true}}
2019-12-03 18:07:34.731 [worker-5-1] c.z.m.p.MqttServerPublishProcess:122  DEBUG - Publish - clientId: jimmy170503941, cleanSession: MqttPublishMessage[fixedHeader=MqttFixedHeader[messageType=PUBLISH, isDup=false, qosLevel=AT_MOST_ONCE, isRetain=false, remainingLength=16], variableHeader=MqttPublishVariableHeader[topicName=807012, packetId=-1], payload=PooledSlicedByteBuf(ridx: 0, widx: 8, cap: 8/8, unwrapped: PooledUnsafeDirectByteBuf(ridx: 18, widx: 18, cap: 480))]
2019-12-03 18:07:34.819 [kafka-producer-network-thread | producer-1] com.zwj.mqtt.cluster.Producer$1:30   DEBUG - kafka topic [hubMqttCluster]  message [{"clientId":"jimmy172320146","retain":false,"dup":false,"topic":"807012","mqttQoS":0,"payload":"AAAAAAAAAAA\u003d"}]  send, resultProducerRecord(topic=hubMqttCluster, partition=null, headers=RecordHeaders(headers = [], isReadOnly = true), key=null, value={"clientId":"jimmy172320146","retain":false,"dup":false,"topic":"807012","mqttQoS":0,"payload":"AAAAAAAAAAA\u003d"}, timestamp=null)
2019-12-03 18:07:34.869 [org.springframework.kafka.KafkaListenerEndpointContainer#0-14-C-1] com.zwj.mqtt.cluster.Consumer:31   DEBUG - revice kafka message:{"clientId":"jimmy172320146","retain":false,"dup":false,"topic":"807012","mqttQoS":0,"payload":"AAAAAAAAAAA\u003d"}
2019-12-03 18:07:34.870 [org.springframework.kafka.KafkaListenerEndpointContainer#0-14-C-1] c.z.m.p.MqttServerPublishProcess:190  DEBUG - PUBLISH - clientId: jimmy172320146, topic: 807012, Qos: 0
2019-12-03 18:07:34.872 [org.springframework.kafka.KafkaListenerEndpointContainer#0-14-C-1] com.zwj.mqtt.cluster.Consumer:31   DEBUG - revice kafka message:{"clientId":"jimmy172320146","retain":false,"dup":false,"topic":"807012","mqttQoS":0,"payload":"AAAAAAAAAAA\u003d"}
2019-12-03 18:07:37.838 [worker-5-1] c.z.m.s.impl.SessionServiceImpl:36   DEBUG - getSessionByClientId,clientId:jimmy170503941,result:{"brokerId":1,"clientId":"jimmy170503941","channelId":"acde48fffe001122-00000742-00000001-2371706d70f15dd0-96890491","cleanSession":true,"willMessage":{"payload":"d2lsbCBtZXNzYWdlAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\u003d\u003d","messageType":3,"isDup":false,"qosLevel":0,"isRetain":false,"remainingLength":0,"topicName":"111","packetId":0,"hasWillMessage":true}}
2019-12-03 18:07:37.839 [worker-5-1] c.z.m.p.MqttServerPublishProcess:122  DEBUG - Publish - clientId: jimmy170503941, cleanSession: MqttPublishMessage[fixedHeader=MqttFixedHeader[messageType=PUBLISH, isDup=false, qosLevel=AT_MOST_ONCE, isRetain=false, remainingLength=16], variableHeader=MqttPublishVariableHeader[topicName=807012, packetId=-1], payload=PooledSlicedByteBuf(ridx: 0, widx: 8, cap: 8/8, unwrapped: PooledUnsafeDirectByteBuf(ridx: 18, widx: 18, cap: 480))]
2019-12-03 18:07:37.948 [kafka-producer-network-thread | producer-1] com.zwj.mqtt.cluster.Producer$1:30   DEBUG - kafka topic [hubMqttCluster]  message [{"clientId":"jimmy172320146","retain":false,"dup":false,"topic":"807012","mqttQoS":0,"payload":"AAAAAAAAAAA\u003d"}]  send, resultProducerRecord(topic=hubMqttCluster, partition=null, headers=RecordHeaders(headers = [], isReadOnly = true), key=null, value={"clientId":"jimmy172320146","retain":false,"dup":false,"topic":"807012","mqttQoS":0,"payload":"AAAAAAAAAAA\u003d"}, timestamp=null)
2019-12-03 18:07:38.006 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] com.zwj.mqtt.cluster.Consumer:31   DEBUG - revice kafka message:{"clientId":"jimmy172320146","retain":false,"dup":false,"topic":"807012","mqttQoS":0,"payload":"AAAAAAAAAAA\u003d"}
2019-12-03 18:07:38.008 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] com.zwj.mqtt.cluster.Consumer:31   DEBUG - revice kafka message:{"clientId":"jimmy172320146","retain":false,"dup":false,"topic":"807012","mqttQoS":0,"payload":"AAAAAAAAAAA\u003d"}
2019-12-03 18:07:38.009 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] c.z.m.p.MqttServerPublishProcess:190  DEBUG - PUBLISH - clientId: jimmy172320146, topic: 807012, Qos: 0
2019-12-03 18:08:05.773 [worker-5-1] c.z.m.p.MqttServerPingReqProcess:39   DEBUG - PINGREQ - clientId: jimmy170503941
2019-12-03 18:08:34.078 [main] o.s.boot.StartupInfoLogger:50   INFO  - Starting Bootstarp on jimmydeMacBook-Pro.local with PID 1872 (/Users/jimmy/IdeaProjects/huzwj/mqttBroker/cloud-mqttBroker/target/classes started by jimmy in /Users/jimmy/IdeaProjects/huzwj/mqttBroker)
2019-12-03 18:08:34.081 [main] o.s.boot.StartupInfoLogger:53   DEBUG - Running with Spring Boot v2.0.7.RELEASE, Spring v5.0.11.RELEASE
2019-12-03 18:08:34.081 [main] o.s.boot.SpringApplication:654  INFO  - No active profile set, falling back to default profiles: default
2019-12-03 18:08:39.490 [main] o.s.boot.StartupInfoLogger:50   INFO  - Starting Bootstarp on jimmydeMacBook-Pro.local with PID 1876 (/Users/jimmy/IdeaProjects/huzwj/mqttBroker/cloud-mqttBroker/target/classes started by jimmy in /Users/jimmy/IdeaProjects/huzwj/mqttBroker)
2019-12-03 18:08:39.494 [main] o.s.boot.StartupInfoLogger:53   DEBUG - Running with Spring Boot v2.0.7.RELEASE, Spring v5.0.11.RELEASE
2019-12-03 18:08:39.495 [main] o.s.boot.SpringApplication:654  INFO  - No active profile set, falling back to default profiles: default
2019-12-03 18:08:40.944 [main] o.s.boot.StartupInfoLogger:59   INFO  - Started Bootstarp in 1.717 seconds (JVM running for 2.471)
2019-12-03 18:08:40.947 [main] com.zwj.mqtt.server.MqttServer:55   INFO  - starting mqtt broker: 2 
2019-12-03 18:08:41.097 [main] com.zwj.mqtt.server.MqttServer:93   INFO  - started mqtt broker: 2 ,host:127.0.0.1, port: 8070
2019-12-03 18:08:58.276 [main] o.s.boot.StartupInfoLogger:50   INFO  - Starting Bootstarp on jimmydeMacBook-Pro.local with PID 1879 (/Users/jimmy/IdeaProjects/huzwj/mqttBroker/cloud-mqttBroker/target/classes started by jimmy in /Users/jimmy/IdeaProjects/huzwj/mqttBroker)
2019-12-03 18:08:58.279 [main] o.s.boot.StartupInfoLogger:53   DEBUG - Running with Spring Boot v2.0.7.RELEASE, Spring v5.0.11.RELEASE
2019-12-03 18:08:58.280 [main] o.s.boot.SpringApplication:654  INFO  - No active profile set, falling back to default profiles: default
2019-12-03 18:08:59.660 [main] o.s.boot.StartupInfoLogger:59   INFO  - Started Bootstarp in 1.655 seconds (JVM running for 2.358)
2019-12-03 18:08:59.662 [main] com.zwj.mqtt.server.MqttServer:55   INFO  - starting mqtt broker: 1 
2019-12-03 18:08:59.783 [main] com.zwj.mqtt.server.MqttServer:93   INFO  - started mqtt broker: 1 ,host:127.0.0.1, port: 9090
2019-12-03 18:09:05.734 [worker-5-1] c.z.m.s.impl.SessionServiceImpl:47   DEBUG - putSessionByClient,clientId:jimmy170503941,sessionModel:{"brokerId":1,"clientId":"jimmy170503941","channelId":"acde48fffe001122-00000757-00000001-af4893772b141bd3-ebdf8556","cleanSession":true,"willMessage":{"payload":"d2lsbCBtZXNzYWdlAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\u003d\u003d","messageType":3,"isDup":false,"qosLevel":0,"isRetain":false,"remainingLength":0,"topicName":"111","packetId":0,"hasWillMessage":true}},mexpire:{}
2019-12-03 18:09:05.782 [worker-5-1] c.z.m.p.MqttServerConnectProcess:146  DEBUG - CONNECT - clientId: jimmy170503941, connectMsg: MqttConnectMessage[fixedHeader=MqttFixedHeader[messageType=CONNECT, isDup=false, qosLevel=AT_MOST_ONCE, isRetain=false, remainingLength=45], variableHeader=MqttConnectVariableHeader[name=MQTT, version=4, hasUserName=false, hasPassword=false, isWillRetain=false, isWillFlag=true, isCleanSession=true, keepAliveTimeSeconds=60], payload=MqttConnectPayload[clientIdentifier=jimmy170503941, willTopic=111, willMessage=[B@77499d91, userName=null, password=null]],connectAckMsg:MqttConnAckMessage[fixedHeader=MqttFixedHeader[messageType=CONNACK, isDup=false, qosLevel=AT_MOST_ONCE, isRetain=false, remainingLength=0], variableHeader=MqttConnAckVariableHeader[connectReturnCode=CONNECTION_ACCEPTED, sessionPresent=false], payload=]
2019-12-03 18:09:20.459 [worker-5-1] c.z.m.s.impl.SessionServiceImpl:47   DEBUG - putSessionByClient,clientId:jimmy172320146,sessionModel:{"brokerId":2,"clientId":"jimmy172320146","channelId":"acde48fffe001122-00000754-00000001-42be98661b14560a-d9352f5f","cleanSession":true,"willMessage":null},mexpire:{}
2019-12-03 18:09:20.508 [worker-5-1] c.z.m.p.MqttServerConnectProcess:146  DEBUG - CONNECT - clientId: jimmy172320146, connectMsg: MqttConnectMessage[fixedHeader=MqttFixedHeader[messageType=CONNECT, isDup=false, qosLevel=AT_MOST_ONCE, isRetain=false, remainingLength=26], variableHeader=MqttConnectVariableHeader[name=MQTT, version=4, hasUserName=false, hasPassword=false, isWillRetain=false, isWillFlag=false, isCleanSession=true, keepAliveTimeSeconds=60], payload=MqttConnectPayload[clientIdentifier=jimmy172320146, willTopic=null, willMessage=null, userName=null, password=null]],connectAckMsg:MqttConnAckMessage[fixedHeader=MqttFixedHeader[messageType=CONNACK, isDup=false, qosLevel=AT_MOST_ONCE, isRetain=false, remainingLength=0], variableHeader=MqttConnAckVariableHeader[connectReturnCode=CONNECTION_ACCEPTED, sessionPresent=false], payload=]
2019-12-03 18:09:29.468 [worker-5-1] c.z.m.p.MqttServerSubscribeProcess:58   DEBUG - subscribe - clientId: jimmy170503941,msg:MqttSubscribeMessage[fixedHeader=MqttFixedHeader[messageType=SUBSCRIBE, isDup=false, qosLevel=AT_LEAST_ONCE, isRetain=false, remainingLength=9], variableHeader=MqttMessageIdVariableHeader[messageId=1], payload=MqttSubscribePayload[MqttTopicSubscription[topicFilter=9090, qualityOfService=AT_MOST_ONCE]]]
2019-12-03 18:09:29.556 [worker-5-1] c.z.m.p.MqttServerSubscribeProcess:70   DEBUG - SUBSCRIBE - clientId: jimmy170503941, topFilter: 9090, QoS: 0
2019-12-03 18:09:32.538 [worker-5-1] c.z.m.p.MqttServerDisConnectProcess:51   DEBUG - DISCONNECT - clientId: jimmy172320146
2019-12-03 18:09:32.587 [worker-5-1] c.z.m.s.impl.SessionServiceImpl:36   DEBUG - getSessionByClientId,clientId:jimmy172320146,result:{"brokerId":2,"clientId":"jimmy172320146","channelId":"acde48fffe001122-00000754-00000001-42be98661b14560a-d9352f5f","cleanSession":true,"willMessage":null}
2019-12-03 18:09:35.560 [worker-5-2] c.z.m.s.impl.SessionServiceImpl:47   DEBUG - putSessionByClient,clientId:jimmy172320146,sessionModel:{"brokerId":2,"clientId":"jimmy172320146","channelId":"acde48fffe001122-00000754-00000004-5ee28963bb1492d3-b3c0c708","cleanSession":true,"willMessage":null},mexpire:{}
2019-12-03 18:09:35.598 [worker-5-2] c.z.m.p.MqttServerConnectProcess:146  DEBUG - CONNECT - clientId: jimmy172320146, connectMsg: MqttConnectMessage[fixedHeader=MqttFixedHeader[messageType=CONNECT, isDup=false, qosLevel=AT_MOST_ONCE, isRetain=false, remainingLength=26], variableHeader=MqttConnectVariableHeader[name=MQTT, version=4, hasUserName=false, hasPassword=false, isWillRetain=false, isWillFlag=false, isCleanSession=true, keepAliveTimeSeconds=60], payload=MqttConnectPayload[clientIdentifier=jimmy172320146, willTopic=null, willMessage=null, userName=null, password=null]],connectAckMsg:MqttConnAckMessage[fixedHeader=MqttFixedHeader[messageType=CONNACK, isDup=false, qosLevel=AT_MOST_ONCE, isRetain=false, remainingLength=0], variableHeader=MqttConnAckVariableHeader[connectReturnCode=CONNECTION_ACCEPTED, sessionPresent=false], payload=]
2019-12-03 18:09:43.470 [worker-5-2] c.z.m.s.impl.SessionServiceImpl:36   DEBUG - getSessionByClientId,clientId:jimmy172320146,result:{"brokerId":2,"clientId":"jimmy172320146","channelId":"acde48fffe001122-00000754-00000004-5ee28963bb1492d3-b3c0c708","cleanSession":true,"willMessage":null}
2019-12-03 18:09:43.471 [worker-5-2] c.z.m.p.MqttServerPublishProcess:122  DEBUG - Publish - clientId: jimmy172320146, cleanSession: MqttPublishMessage[fixedHeader=MqttFixedHeader[messageType=PUBLISH, isDup=false, qosLevel=AT_MOST_ONCE, isRetain=false, remainingLength=13], variableHeader=MqttPublishVariableHeader[topicName=9090, packetId=-1], payload=PooledSlicedByteBuf(ridx: 0, widx: 7, cap: 7/7, unwrapped: PooledUnsafeDirectByteBuf(ridx: 15, widx: 15, cap: 1024))]
2019-12-03 18:09:44.131 [kafka-producer-network-thread | producer-1] com.zwj.mqtt.cluster.Producer$1:30   DEBUG - kafka topic [hubMqttCluster]  message [{"clientId":"jimmy170503941","retain":false,"dup":false,"topic":"9090","mqttQoS":0,"payload":"AAAAAAAAAA\u003d\u003d"}]  send, resultProducerRecord(topic=hubMqttCluster, partition=null, headers=RecordHeaders(headers = [], isReadOnly = true), key=null, value={"clientId":"jimmy170503941","retain":false,"dup":false,"topic":"9090","mqttQoS":0,"payload":"AAAAAAAAAA\u003d\u003d"}, timestamp=null)
2019-12-03 18:09:50.703 [org.springframework.kafka.KafkaListenerEndpointContainer#0-3-C-1] com.zwj.mqtt.cluster.Consumer:31   DEBUG - revice kafka message:{"clientId":"jimmy170503941","retain":false,"dup":false,"topic":"9090","mqttQoS":0,"payload":"AAAAAAAAAA\u003d\u003d"}
2019-12-03 18:10:29.836 [org.springframework.kafka.KafkaListenerEndpointContainer#0-3-C-1] com.zwj.mqtt.cluster.Consumer:31   DEBUG - revice kafka message:{"clientId":"jimmy170503941","retain":false,"dup":false,"topic":"9090","mqttQoS":0,"payload":"AAAAAAAAAA\u003d\u003d"}
2019-12-03 18:10:29.884 [worker-5-1] c.z.m.p.MqttServerPingReqProcess:39   DEBUG - PINGREQ - clientId: jimmy170503941
2019-12-03 18:10:29.885 [org.springframework.kafka.KafkaListenerEndpointContainer#0-3-C-1] c.z.m.p.MqttServerPublishProcess:190  DEBUG - PUBLISH - clientId: jimmy170503941, topic: 9090, Qos: 0
2019-12-03 18:15:58.053 [main] o.s.boot.StartupInfoLogger:50   INFO  - Starting Bootstarp on jimmydeMacBook-Pro.local with PID 1894 (/Users/jimmy/IdeaProjects/huzwj/mqttBroker/cloud-mqttBroker/target/classes started by jimmy in /Users/jimmy/IdeaProjects/huzwj/mqttBroker)
2019-12-03 18:15:58.056 [main] o.s.boot.StartupInfoLogger:53   DEBUG - Running with Spring Boot v2.0.7.RELEASE, Spring v5.0.11.RELEASE
2019-12-03 18:15:58.057 [main] o.s.boot.SpringApplication:654  INFO  - No active profile set, falling back to default profiles: default
2019-12-03 18:16:02.907 [main] o.s.boot.StartupInfoLogger:50   INFO  - Starting Bootstarp on jimmydeMacBook-Pro.local with PID 1899 (/Users/jimmy/IdeaProjects/huzwj/mqttBroker/cloud-mqttBroker/target/classes started by jimmy in /Users/jimmy/IdeaProjects/huzwj/mqttBroker)
2019-12-03 18:16:02.911 [main] o.s.boot.StartupInfoLogger:53   DEBUG - Running with Spring Boot v2.0.7.RELEASE, Spring v5.0.11.RELEASE
2019-12-03 18:16:02.911 [main] o.s.boot.SpringApplication:654  INFO  - No active profile set, falling back to default profiles: default
2019-12-03 18:16:04.290 [main] o.s.boot.StartupInfoLogger:59   INFO  - Started Bootstarp in 1.657 seconds (JVM running for 2.377)
2019-12-03 18:16:04.293 [main] com.zwj.mqtt.server.MqttServer:55   INFO  - starting mqtt broker: 1 
2019-12-03 18:16:04.468 [main] com.zwj.mqtt.server.MqttServer:93   INFO  - started mqtt broker: 1 ,host:127.0.0.1, port: 9090
2019-12-03 18:16:14.794 [org.springframework.kafka.KafkaListenerEndpointContainer#0-4-C-1] com.zwj.mqtt.cluster.Consumer:32   DEBUG - revice kafka message:{"clientId":"jimmy170503941","retain":false,"dup":false,"topic":"9090","mqttQoS":0,"payload":"AAAAAAAAAA\u003d\u003d"}
2019-12-03 18:16:42.993 [org.springframework.kafka.KafkaListenerEndpointContainer#0-3-C-1] com.zwj.mqtt.cluster.Consumer:32   DEBUG - revice kafka message:{"clientId":"jimmy170503941","retain":false,"dup":false,"topic":"9090","mqttQoS":0,"payload":"AAAAAAAAAA\u003d\u003d"}
2019-12-03 18:17:11.659 [main] o.s.boot.StartupInfoLogger:50   INFO  - Starting Bootstarp on jimmydeMacBook-Pro.local with PID 1904 (/Users/jimmy/IdeaProjects/huzwj/mqttBroker/cloud-mqttBroker/target/classes started by jimmy in /Users/jimmy/IdeaProjects/huzwj/mqttBroker)
2019-12-03 18:17:11.662 [main] o.s.boot.StartupInfoLogger:53   DEBUG - Running with Spring Boot v2.0.7.RELEASE, Spring v5.0.11.RELEASE
2019-12-03 18:17:11.663 [main] o.s.boot.SpringApplication:654  INFO  - No active profile set, falling back to default profiles: default
2019-12-03 18:17:13.012 [main] o.s.boot.StartupInfoLogger:59   INFO  - Started Bootstarp in 1.633 seconds (JVM running for 2.313)
2019-12-03 18:17:13.016 [main] com.zwj.mqtt.server.MqttServer:55   INFO  - starting mqtt broker: 2 
2019-12-03 18:17:13.186 [main] com.zwj.mqtt.server.MqttServer:93   INFO  - started mqtt broker: 2 ,host:127.0.0.1, port: 8070
2019-12-03 18:17:17.844 [org.springframework.kafka.KafkaListenerEndpointContainer#0-3-C-1] com.zwj.mqtt.cluster.Consumer:32   DEBUG - revice kafka message:{"clientId":"jimmy170503941","retain":false,"dup":false,"topic":"9090","mqttQoS":0,"payload":"AAAAAAAAAA\u003d\u003d"}
2019-12-03 18:17:27.625 [worker-5-1] c.z.m.s.impl.SessionServiceImpl:47   DEBUG - putSessionByClient,clientId:jimmy170503941,sessionModel:{"brokerId":1,"clientId":"jimmy170503941","channelId":"acde48fffe001122-0000076b-00000001-e53bfd52f56bc0bd-eddb72c5","cleanSession":true,"willMessage":{"payload":"d2lsbCBtZXNzYWdlAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\u003d\u003d","messageType":3,"isDup":false,"qosLevel":0,"isRetain":false,"remainingLength":0,"topicName":"111","packetId":0,"hasWillMessage":true}},mexpire:{}
2019-12-03 18:17:27.671 [worker-5-1] c.z.m.p.MqttServerConnectProcess:146  DEBUG - CONNECT - clientId: jimmy170503941, connectMsg: MqttConnectMessage[fixedHeader=MqttFixedHeader[messageType=CONNECT, isDup=false, qosLevel=AT_MOST_ONCE, isRetain=false, remainingLength=45], variableHeader=MqttConnectVariableHeader[name=MQTT, version=4, hasUserName=false, hasPassword=false, isWillRetain=false, isWillFlag=true, isCleanSession=true, keepAliveTimeSeconds=60], payload=MqttConnectPayload[clientIdentifier=jimmy170503941, willTopic=111, willMessage=[B@2aeaa8e8, userName=null, password=null]],connectAckMsg:MqttConnAckMessage[fixedHeader=MqttFixedHeader[messageType=CONNACK, isDup=false, qosLevel=AT_MOST_ONCE, isRetain=false, remainingLength=0], variableHeader=MqttConnAckVariableHeader[connectReturnCode=CONNECTION_ACCEPTED, sessionPresent=false], payload=]
2019-12-03 18:17:30.107 [worker-5-1] c.z.m.s.impl.SessionServiceImpl:47   DEBUG - putSessionByClient,clientId:jimmy172320146,sessionModel:{"brokerId":2,"clientId":"jimmy172320146","channelId":"acde48fffe001122-00000770-00000001-d6e17c26756bcecc-4d803714","cleanSession":true,"willMessage":null},mexpire:{}
2019-12-03 18:17:30.154 [worker-5-1] c.z.m.p.MqttServerConnectProcess:146  DEBUG - CONNECT - clientId: jimmy172320146, connectMsg: MqttConnectMessage[fixedHeader=MqttFixedHeader[messageType=CONNECT, isDup=false, qosLevel=AT_MOST_ONCE, isRetain=false, remainingLength=26], variableHeader=MqttConnectVariableHeader[name=MQTT, version=4, hasUserName=false, hasPassword=false, isWillRetain=false, isWillFlag=false, isCleanSession=true, keepAliveTimeSeconds=60], payload=MqttConnectPayload[clientIdentifier=jimmy172320146, willTopic=null, willMessage=null, userName=null, password=null]],connectAckMsg:MqttConnAckMessage[fixedHeader=MqttFixedHeader[messageType=CONNACK, isDup=false, qosLevel=AT_MOST_ONCE, isRetain=false, remainingLength=0], variableHeader=MqttConnAckVariableHeader[connectReturnCode=CONNECTION_ACCEPTED, sessionPresent=false], payload=]
2019-12-03 18:17:38.966 [worker-5-1] c.z.m.p.MqttServerSubscribeProcess:58   DEBUG - subscribe - clientId: jimmy170503941,msg:MqttSubscribeMessage[fixedHeader=MqttFixedHeader[messageType=SUBSCRIBE, isDup=false, qosLevel=AT_LEAST_ONCE, isRetain=false, remainingLength=9], variableHeader=MqttMessageIdVariableHeader[messageId=1], payload=MqttSubscribePayload[MqttTopicSubscription[topicFilter=9090, qualityOfService=AT_MOST_ONCE]]]
2019-12-03 18:17:39.042 [worker-5-1] c.z.m.p.MqttServerSubscribeProcess:70   DEBUG - SUBSCRIBE - clientId: jimmy170503941, topFilter: 9090, QoS: 0
2019-12-03 18:17:43.449 [worker-5-1] c.z.m.s.impl.SessionServiceImpl:36   DEBUG - getSessionByClientId,clientId:jimmy172320146,result:{"brokerId":2,"clientId":"jimmy172320146","channelId":"acde48fffe001122-00000770-00000001-d6e17c26756bcecc-4d803714","cleanSession":true,"willMessage":null}
2019-12-03 18:17:43.450 [worker-5-1] c.z.m.p.MqttServerPublishProcess:123  DEBUG - Publish - clientId: jimmy172320146, cleanSession: MqttPublishMessage[fixedHeader=MqttFixedHeader[messageType=PUBLISH, isDup=false, qosLevel=AT_MOST_ONCE, isRetain=false, remainingLength=13], variableHeader=MqttPublishVariableHeader[topicName=9090, packetId=-1], payload=PooledSlicedByteBuf(ridx: 0, widx: 7, cap: 7/7, unwrapped: PooledUnsafeDirectByteBuf(ridx: 15, widx: 15, cap: 1024))]
2019-12-03 18:17:43.800 [kafka-producer-network-thread | producer-1] com.zwj.mqtt.cluster.Producer$1:30   DEBUG - kafka topic [hubMqttCluster]  message [{"clientId":"jimmy170503941","retain":false,"dup":false,"topic":"9090","mqttQoS":0,"payload":"AAAAAAAAAA\u003d\u003d"}]  send, resultProducerRecord(topic=hubMqttCluster, partition=null, headers=RecordHeaders(headers = [], isReadOnly = true), key=null, value={"clientId":"jimmy170503941","retain":false,"dup":false,"topic":"9090","mqttQoS":0,"payload":"AAAAAAAAAA\u003d\u003d"}, timestamp=null)
2019-12-03 18:17:49.658 [org.springframework.kafka.KafkaListenerEndpointContainer#0-4-C-1] com.zwj.mqtt.cluster.Consumer:32   DEBUG - revice kafka message:{"clientId":"jimmy170503941","retain":false,"dup":false,"topic":"9090","mqttQoS":0,"payload":"AAAAAAAAAA\u003d\u003d"}
2019-12-03 18:17:57.734 [org.springframework.kafka.KafkaListenerEndpointContainer#0-4-C-1] com.zwj.mqtt.cluster.Consumer:32   DEBUG - revice kafka message:{"clientId":"jimmy170503941","retain":false,"dup":false,"topic":"9090","mqttQoS":0,"payload":"AAAAAAAAAA\u003d\u003d"}
2019-12-03 18:18:17.773 [org.springframework.kafka.KafkaListenerEndpointContainer#0-4-C-1] c.z.m.p.MqttServerPublishProcess:191  DEBUG - PUBLISH - clientId: jimmy170503941, topic: 9090, Qos: 0
2019-12-03 18:18:23.330 [org.springframework.kafka.KafkaListenerEndpointContainer#0-4-C-1] com.zwj.mqtt.cluster.Consumer:32   DEBUG - revice kafka message:{"clientId":"jimmy170503941","retain":false,"dup":false,"topic":"9090","mqttQoS":0,"payload":"AAAAAAAAAA\u003d\u003d"}
2019-12-03 18:18:30.161 [worker-5-1] c.z.m.p.MqttServerPingReqProcess:39   DEBUG - PINGREQ - clientId: jimmy172320146
2019-12-03 18:18:46.759 [worker-5-1] c.z.m.p.MqttServerPingReqProcess:39   DEBUG - PINGREQ - clientId: jimmy170503941
2019-12-03 18:18:49.509 [org.springframework.kafka.KafkaListenerEndpointContainer#0-4-C-1] c.z.m.p.MqttServerPublishProcess:191  DEBUG - PUBLISH - clientId: jimmy170503941, topic: 9090, Qos: 0
2019-12-03 18:20:03.819 [main] o.s.boot.StartupInfoLogger:50   INFO  - Starting Bootstarp on jimmydeMacBook-Pro.local with PID 1910 (/Users/jimmy/IdeaProjects/huzwj/mqttBroker/cloud-mqttBroker/target/classes started by jimmy in /Users/jimmy/IdeaProjects/huzwj/mqttBroker)
2019-12-03 18:20:03.823 [main] o.s.boot.StartupInfoLogger:53   DEBUG - Running with Spring Boot v2.0.7.RELEASE, Spring v5.0.11.RELEASE
2019-12-03 18:20:03.824 [main] o.s.boot.SpringApplication:654  INFO  - No active profile set, falling back to default profiles: default
2019-12-03 18:20:05.185 [main] o.s.boot.StartupInfoLogger:59   INFO  - Started Bootstarp in 1.667 seconds (JVM running for 2.392)
2019-12-03 18:20:05.189 [main] com.zwj.mqtt.server.MqttServer:55   INFO  - starting mqtt broker: 2 
2019-12-03 18:20:05.350 [main] com.zwj.mqtt.server.MqttServer:93   INFO  - started mqtt broker: 2 ,host:127.0.0.1, port: 8070
2019-12-03 18:20:28.332 [main] o.s.boot.StartupInfoLogger:50   INFO  - Starting Bootstarp on jimmydeMacBook-Pro.local with PID 1913 (/Users/jimmy/IdeaProjects/huzwj/mqttBroker/cloud-mqttBroker/target/classes started by jimmy in /Users/jimmy/IdeaProjects/huzwj/mqttBroker)
2019-12-03 18:20:28.336 [main] o.s.boot.StartupInfoLogger:53   DEBUG - Running with Spring Boot v2.0.7.RELEASE, Spring v5.0.11.RELEASE
2019-12-03 18:20:28.336 [main] o.s.boot.SpringApplication:654  INFO  - No active profile set, falling back to default profiles: default
2019-12-03 18:20:29.736 [main] o.s.boot.StartupInfoLogger:59   INFO  - Started Bootstarp in 1.673 seconds (JVM running for 2.384)
2019-12-03 18:20:29.739 [main] com.zwj.mqtt.server.MqttServer:55   INFO  - starting mqtt broker: 1 
2019-12-03 18:20:29.939 [main] com.zwj.mqtt.server.MqttServer:93   INFO  - started mqtt broker: 1 ,host:127.0.0.1, port: 9090
2019-12-03 18:20:30.584 [org.springframework.kafka.KafkaListenerEndpointContainer#0-4-C-1] com.zwj.mqtt.cluster.Consumer:32   DEBUG - revice kafka message:{"clientId":"jimmy170503941","retain":false,"dup":false,"topic":"9090","mqttQoS":0,"payload":"AAAAAAAAAA\u003d\u003d"}
2019-12-03 18:23:15.856 [worker-5-1] c.z.m.s.impl.SessionServiceImpl:47   DEBUG - putSessionByClient,clientId:jimmy170503941,sessionModel:{"brokerId":1,"clientId":"jimmy170503941","channelId":"acde48fffe001122-00000779-00000001-4d3a44e77861155f-d65711ae","cleanSession":true,"willMessage":{"payload":"d2lsbCBtZXNzYWdlAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\u003d\u003d","messageType":3,"isDup":false,"qosLevel":0,"isRetain":false,"remainingLength":0,"topicName":"111","packetId":0,"hasWillMessage":true}},mexpire:{}
2019-12-03 18:23:15.902 [worker-5-1] c.z.m.p.MqttServerConnectProcess:146  DEBUG - CONNECT - clientId: jimmy170503941, connectMsg: MqttConnectMessage[fixedHeader=MqttFixedHeader[messageType=CONNECT, isDup=false, qosLevel=AT_MOST_ONCE, isRetain=false, remainingLength=45], variableHeader=MqttConnectVariableHeader[name=MQTT, version=4, hasUserName=false, hasPassword=false, isWillRetain=false, isWillFlag=true, isCleanSession=true, keepAliveTimeSeconds=60], payload=MqttConnectPayload[clientIdentifier=jimmy170503941, willTopic=111, willMessage=[B@34eabb0f, userName=null, password=null]],connectAckMsg:MqttConnAckMessage[fixedHeader=MqttFixedHeader[messageType=CONNACK, isDup=false, qosLevel=AT_MOST_ONCE, isRetain=false, remainingLength=0], variableHeader=MqttConnAckVariableHeader[connectReturnCode=CONNECTION_ACCEPTED, sessionPresent=false], payload=]
2019-12-03 18:23:19.068 [worker-5-1] c.z.m.s.impl.SessionServiceImpl:47   DEBUG - putSessionByClient,clientId:jimmy172320146,sessionModel:{"brokerId":2,"clientId":"jimmy172320146","channelId":"acde48fffe001122-00000776-00000001-84f797e4b86121f1-0f20f292","cleanSession":true,"willMessage":null},mexpire:{}
2019-12-03 18:23:19.129 [worker-5-1] c.z.m.p.MqttServerConnectProcess:146  DEBUG - CONNECT - clientId: jimmy172320146, connectMsg: MqttConnectMessage[fixedHeader=MqttFixedHeader[messageType=CONNECT, isDup=false, qosLevel=AT_MOST_ONCE, isRetain=false, remainingLength=26], variableHeader=MqttConnectVariableHeader[name=MQTT, version=4, hasUserName=false, hasPassword=false, isWillRetain=false, isWillFlag=false, isCleanSession=true, keepAliveTimeSeconds=60], payload=MqttConnectPayload[clientIdentifier=jimmy172320146, willTopic=null, willMessage=null, userName=null, password=null]],connectAckMsg:MqttConnAckMessage[fixedHeader=MqttFixedHeader[messageType=CONNACK, isDup=false, qosLevel=AT_MOST_ONCE, isRetain=false, remainingLength=0], variableHeader=MqttConnAckVariableHeader[connectReturnCode=CONNECTION_ACCEPTED, sessionPresent=false], payload=]
2019-12-03 18:23:26.891 [worker-5-1] c.z.m.p.MqttServerSubscribeProcess:58   DEBUG - subscribe - clientId: jimmy170503941,msg:MqttSubscribeMessage[fixedHeader=MqttFixedHeader[messageType=SUBSCRIBE, isDup=false, qosLevel=AT_LEAST_ONCE, isRetain=false, remainingLength=9], variableHeader=MqttMessageIdVariableHeader[messageId=1], payload=MqttSubscribePayload[MqttTopicSubscription[topicFilter=9090, qualityOfService=AT_MOST_ONCE]]]
2019-12-03 18:23:26.967 [worker-5-1] c.z.m.p.MqttServerSubscribeProcess:70   DEBUG - SUBSCRIBE - clientId: jimmy170503941, topFilter: 9090, QoS: 0
2019-12-03 18:23:42.579 [worker-5-1] c.z.m.s.impl.SessionServiceImpl:36   DEBUG - getSessionByClientId,clientId:jimmy172320146,result:{"brokerId":2,"clientId":"jimmy172320146","channelId":"acde48fffe001122-00000776-00000001-84f797e4b86121f1-0f20f292","cleanSession":true,"willMessage":null}
2019-12-03 18:23:42.581 [worker-5-1] c.z.m.p.MqttServerPublishProcess:123  DEBUG - Publish - clientId: jimmy172320146, cleanSession: MqttPublishMessage[fixedHeader=MqttFixedHeader[messageType=PUBLISH, isDup=false, qosLevel=AT_MOST_ONCE, isRetain=false, remainingLength=13], variableHeader=MqttPublishVariableHeader[topicName=9090, packetId=-1], payload=PooledSlicedByteBuf(ridx: 0, widx: 7, cap: 7/7, unwrapped: PooledUnsafeDirectByteBuf(ridx: 15, widx: 15, cap: 1024))]
2019-12-03 18:24:26.896 [worker-5-1] c.z.m.p.MqttServerPingReqProcess:39   DEBUG - PINGREQ - clientId: jimmy170503941
2019-12-03 18:24:30.299 [worker-5-1] c.z.m.p.MqttServerPingReqProcess:39   DEBUG - PINGREQ - clientId: jimmy172320146
2019-12-03 18:24:30.426 [kafka-producer-network-thread | producer-1] com.zwj.mqtt.cluster.Producer$1:30   DEBUG - kafka topic [hubMqttCluster]  message [{"clientId":"jimmy170503941","retain":false,"dup":false,"topic":"9090","mqttQoS":0,"payload":"AAAAAAAAAA\u003d\u003d"}]  send, resultProducerRecord(topic=hubMqttCluster, partition=null, headers=RecordHeaders(headers = [], isReadOnly = true), key=null, value={"clientId":"jimmy170503941","retain":false,"dup":false,"topic":"9090","mqttQoS":0,"payload":"AAAAAAAAAA\u003d\u003d"}, timestamp=null)
2019-12-03 18:26:06.389 [main] o.s.boot.StartupInfoLogger:50   INFO  - Starting Bootstarp on jimmydeMacBook-Pro.local with PID 1923 (/Users/jimmy/IdeaProjects/huzwj/mqttBroker/cloud-mqttBroker/target/classes started by jimmy in /Users/jimmy/IdeaProjects/huzwj/mqttBroker)
2019-12-03 18:26:06.393 [main] o.s.boot.StartupInfoLogger:53   DEBUG - Running with Spring Boot v2.0.7.RELEASE, Spring v5.0.11.RELEASE
2019-12-03 18:26:06.393 [main] o.s.boot.SpringApplication:654  INFO  - No active profile set, falling back to default profiles: default
2019-12-03 18:26:07.641 [main] o.s.boot.StartupInfoLogger:59   INFO  - Started Bootstarp in 1.501 seconds (JVM running for 2.038)
2019-12-03 18:26:07.644 [main] com.zwj.mqtt.server.MqttServer:55   INFO  - starting mqtt broker: 1 
2019-12-03 18:26:07.734 [main] com.zwj.mqtt.server.MqttServer:93   INFO  - started mqtt broker: 1 ,host:127.0.0.1, port: 9090
2019-12-03 18:26:08.314 [org.springframework.kafka.KafkaListenerEndpointContainer#0-12-C-1] com.zwj.mqtt.cluster.Consumer:32   DEBUG - revice kafka message:{"clientId":"jimmy170503941","retain":false,"dup":false,"topic":"9090","mqttQoS":0,"payload":"AAAAAAAAAA\u003d\u003d"}
2019-12-03 18:26:33.947 [main] o.s.boot.StartupInfoLogger:50   INFO  - Starting Bootstarp on jimmydeMacBook-Pro.local with PID 1928 (/Users/jimmy/IdeaProjects/huzwj/mqttBroker/cloud-mqttBroker/target/classes started by jimmy in /Users/jimmy/IdeaProjects/huzwj/mqttBroker)
2019-12-03 18:26:33.952 [main] o.s.boot.StartupInfoLogger:53   DEBUG - Running with Spring Boot v2.0.7.RELEASE, Spring v5.0.11.RELEASE
2019-12-03 18:26:33.953 [main] o.s.boot.SpringApplication:654  INFO  - No active profile set, falling back to default profiles: default
2019-12-03 18:26:35.359 [main] o.s.boot.StartupInfoLogger:59   INFO  - Started Bootstarp in 1.695 seconds (JVM running for 2.406)
2019-12-03 18:26:35.362 [main] com.zwj.mqtt.server.MqttServer:55   INFO  - starting mqtt broker: 2 
2019-12-03 18:26:35.538 [main] com.zwj.mqtt.server.MqttServer:93   INFO  - started mqtt broker: 2 ,host:127.0.0.1, port: 8070
2019-12-03 18:26:43.246 [org.springframework.kafka.KafkaListenerEndpointContainer#0-11-C-1] com.zwj.mqtt.cluster.Consumer:32   DEBUG - revice kafka message:{"clientId":"jimmy170503941","retain":false,"dup":false,"topic":"9090","mqttQoS":0,"payload":"AAAAAAAAAA\u003d\u003d"}
2019-12-03 18:27:02.472 [main] o.s.boot.StartupInfoLogger:50   INFO  - Starting Bootstarp on jimmydeMacBook-Pro.local with PID 1931 (/Users/jimmy/IdeaProjects/huzwj/mqttBroker/cloud-mqttBroker/target/classes started by jimmy in /Users/jimmy/IdeaProjects/huzwj/mqttBroker)
2019-12-03 18:27:02.475 [main] o.s.boot.StartupInfoLogger:53   DEBUG - Running with Spring Boot v2.0.7.RELEASE, Spring v5.0.11.RELEASE
2019-12-03 18:27:02.476 [main] o.s.boot.SpringApplication:654  INFO  - No active profile set, falling back to default profiles: default
2019-12-03 18:27:03.924 [main] o.s.boot.StartupInfoLogger:59   INFO  - Started Bootstarp in 1.729 seconds (JVM running for 2.411)
2019-12-03 18:27:03.926 [main] com.zwj.mqtt.server.MqttServer:55   INFO  - starting mqtt broker: 1 
2019-12-03 18:27:04.067 [main] com.zwj.mqtt.server.MqttServer:93   INFO  - started mqtt broker: 1 ,host:127.0.0.1, port: 9090
2019-12-03 18:27:12.524 [worker-5-1] c.z.m.s.impl.SessionServiceImpl:47   DEBUG - putSessionByClient,clientId:jimmy170503941,sessionModel:{"brokerId":1,"clientId":"jimmy170503941","channelId":"acde48fffe001122-0000078b-00000001-ad1100dbebe4b1f4-37d2577a","cleanSession":true,"willMessage":{"payload":"d2lsbCBtZXNzYWdlAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\u003d\u003d","messageType":3,"isDup":false,"qosLevel":0,"isRetain":false,"remainingLength":0,"topicName":"111","packetId":0,"hasWillMessage":true}},mexpire:{}
2019-12-03 18:27:12.572 [worker-5-1] c.z.m.p.MqttServerConnectProcess:146  DEBUG - CONNECT - clientId: jimmy170503941, connectMsg: MqttConnectMessage[fixedHeader=MqttFixedHeader[messageType=CONNECT, isDup=false, qosLevel=AT_MOST_ONCE, isRetain=false, remainingLength=45], variableHeader=MqttConnectVariableHeader[name=MQTT, version=4, hasUserName=false, hasPassword=false, isWillRetain=false, isWillFlag=true, isCleanSession=true, keepAliveTimeSeconds=60], payload=MqttConnectPayload[clientIdentifier=jimmy170503941, willTopic=111, willMessage=[B@62b071e0, userName=null, password=null]],connectAckMsg:MqttConnAckMessage[fixedHeader=MqttFixedHeader[messageType=CONNACK, isDup=false, qosLevel=AT_MOST_ONCE, isRetain=false, remainingLength=0], variableHeader=MqttConnAckVariableHeader[connectReturnCode=CONNECTION_ACCEPTED, sessionPresent=false], payload=]
2019-12-03 18:27:16.198 [worker-5-1] c.z.m.s.impl.SessionServiceImpl:47   DEBUG - putSessionByClient,clientId:jimmy172320146,sessionModel:{"brokerId":2,"clientId":"jimmy172320146","channelId":"acde48fffe001122-00000788-00000001-353330ff6be4c060-50126e4d","cleanSession":true,"willMessage":null},mexpire:{}
2019-12-03 18:27:16.246 [worker-5-1] c.z.m.p.MqttServerConnectProcess:146  DEBUG - CONNECT - clientId: jimmy172320146, connectMsg: MqttConnectMessage[fixedHeader=MqttFixedHeader[messageType=CONNECT, isDup=false, qosLevel=AT_MOST_ONCE, isRetain=false, remainingLength=26], variableHeader=MqttConnectVariableHeader[name=MQTT, version=4, hasUserName=false, hasPassword=false, isWillRetain=false, isWillFlag=false, isCleanSession=true, keepAliveTimeSeconds=60], payload=MqttConnectPayload[clientIdentifier=jimmy172320146, willTopic=null, willMessage=null, userName=null, password=null]],connectAckMsg:MqttConnAckMessage[fixedHeader=MqttFixedHeader[messageType=CONNACK, isDup=false, qosLevel=AT_MOST_ONCE, isRetain=false, remainingLength=0], variableHeader=MqttConnAckVariableHeader[connectReturnCode=CONNECTION_ACCEPTED, sessionPresent=false], payload=]
2019-12-03 18:27:22.320 [worker-5-1] c.z.m.p.MqttServerSubscribeProcess:58   DEBUG - subscribe - clientId: jimmy170503941,msg:MqttSubscribeMessage[fixedHeader=MqttFixedHeader[messageType=SUBSCRIBE, isDup=false, qosLevel=AT_LEAST_ONCE, isRetain=false, remainingLength=9], variableHeader=MqttMessageIdVariableHeader[messageId=1], payload=MqttSubscribePayload[MqttTopicSubscription[topicFilter=9090, qualityOfService=AT_MOST_ONCE]]]
2019-12-03 18:27:22.396 [worker-5-1] c.z.m.p.MqttServerSubscribeProcess:70   DEBUG - SUBSCRIBE - clientId: jimmy170503941, topFilter: 9090, QoS: 0
2019-12-03 18:27:26.020 [worker-5-1] c.z.m.s.impl.SessionServiceImpl:36   DEBUG - getSessionByClientId,clientId:jimmy172320146,result:{"brokerId":2,"clientId":"jimmy172320146","channelId":"acde48fffe001122-00000788-00000001-353330ff6be4c060-50126e4d","cleanSession":true,"willMessage":null}
2019-12-03 18:27:26.021 [worker-5-1] c.z.m.p.MqttServerPublishProcess:124  DEBUG - Publish - clientId: jimmy172320146, cleanSession: MqttPublishMessage[fixedHeader=MqttFixedHeader[messageType=PUBLISH, isDup=false, qosLevel=AT_MOST_ONCE, isRetain=false, remainingLength=13], variableHeader=MqttPublishVariableHeader[topicName=9090, packetId=-1], payload=PooledSlicedByteBuf(ridx: 7, widx: 7, cap: 7/7, unwrapped: PooledUnsafeDirectByteBuf(ridx: 15, widx: 15, cap: 1024))]
2019-12-03 18:27:37.250 [kafka-producer-network-thread | producer-1] com.zwj.mqtt.cluster.Producer$1:30   DEBUG - kafka topic [hubMqttCluster]  message [{"clientId":"jimmy170503941","retain":false,"dup":false,"topic":"9090","mqttQoS":0,"payload":"aGkgOTA5MA\u003d\u003d"}]  send, resultProducerRecord(topic=hubMqttCluster, partition=null, headers=RecordHeaders(headers = [], isReadOnly = true), key=null, value={"clientId":"jimmy170503941","retain":false,"dup":false,"topic":"9090","mqttQoS":0,"payload":"aGkgOTA5MA\u003d\u003d"}, timestamp=null)
2019-12-03 18:27:41.387 [org.springframework.kafka.KafkaListenerEndpointContainer#0-3-C-1] com.zwj.mqtt.cluster.Consumer:32   DEBUG - revice kafka message:{"clientId":"jimmy170503941","retain":false,"dup":false,"topic":"9090","mqttQoS":0,"payload":"aGkgOTA5MA\u003d\u003d"}
2019-12-03 18:28:11.120 [org.springframework.kafka.KafkaListenerEndpointContainer#0-3-C-1] c.z.m.p.MqttServerPublishProcess:192  DEBUG - PUBLISH - clientId: jimmy170503941, topic: 9090, Qos: 0
2019-12-03 18:28:22.323 [worker-5-1] c.z.m.p.MqttServerPingReqProcess:39   DEBUG - PINGREQ - clientId: jimmy170503941
2019-12-03 18:28:33.116 [org.springframework.kafka.KafkaListenerEndpointContainer#0-3-C-1] com.zwj.mqtt.cluster.Consumer:32   DEBUG - revice kafka message:{"clientId":"jimmy170503941","retain":false,"dup":false,"topic":"9090","mqttQoS":0,"payload":"aGkgOTA5MA\u003d\u003d"}
2019-12-03 18:28:34.304 [org.springframework.kafka.KafkaListenerEndpointContainer#0-3-C-1] c.z.m.p.MqttServerPublishProcess:192  DEBUG - PUBLISH - clientId: jimmy170503941, topic: 9090, Qos: 0
2019-12-03 18:29:22.328 [worker-5-1] c.z.m.p.MqttServerPingReqProcess:39   DEBUG - PINGREQ - clientId: jimmy170503941
2019-12-03 18:29:33.893 [worker-5-1] c.z.m.p.MqttServerPingReqProcess:39   DEBUG - PINGREQ - clientId: jimmy172320146
2019-12-03 18:29:33.893 [org.springframework.kafka.KafkaListenerEndpointContainer#0-3-C-1] com.zwj.mqtt.cluster.Consumer:32   DEBUG - revice kafka message:{"clientId":"jimmy170503941","retain":false,"dup":false,"topic":"9090","mqttQoS":0,"payload":"aGkgOTA5MA\u003d\u003d"}
2019-12-03 18:29:33.930 [worker-5-1] c.z.m.s.impl.SessionServiceImpl:36   DEBUG - getSessionByClientId,clientId:jimmy172320146,result:{"brokerId":2,"clientId":"jimmy172320146","channelId":"acde48fffe001122-00000788-00000001-353330ff6be4c060-50126e4d","cleanSession":true,"willMessage":null}
2019-12-03 18:29:33.931 [worker-5-1] c.z.m.p.MqttServerPublishProcess:124  DEBUG - Publish - clientId: jimmy172320146, cleanSession: MqttPublishMessage[fixedHeader=MqttFixedHeader[messageType=PUBLISH, isDup=false, qosLevel=AT_MOST_ONCE, isRetain=false, remainingLength=13], variableHeader=MqttPublishVariableHeader[topicName=9090, packetId=-1], payload=PooledSlicedByteBuf(ridx: 7, widx: 7, cap: 7/7, unwrapped: PooledUnsafeDirectByteBuf(ridx: 17, widx: 52, cap: 512))]
2019-12-03 18:29:36.637 [kafka-producer-network-thread | producer-1] com.zwj.mqtt.cluster.Producer$1:30   DEBUG - kafka topic [hubMqttCluster]  message [{"clientId":"jimmy170503941","retain":false,"dup":false,"topic":"9090","mqttQoS":0,"payload":"aGkgOTA5MQ\u003d\u003d"}]  send, resultProducerRecord(topic=hubMqttCluster, partition=null, headers=RecordHeaders(headers = [], isReadOnly = true), key=null, value={"clientId":"jimmy170503941","retain":false,"dup":false,"topic":"9090","mqttQoS":0,"payload":"aGkgOTA5MQ\u003d\u003d"}, timestamp=null)
2019-12-03 18:29:36.667 [worker-5-1] c.z.m.s.impl.SessionServiceImpl:36   DEBUG - getSessionByClientId,clientId:jimmy172320146,result:null
2019-12-03 18:29:36.667 [worker-5-1] c.z.m.p.MqttServerPublishProcess:124  DEBUG - Publish - clientId: jimmy172320146, cleanSession: MqttPublishMessage[fixedHeader=MqttFixedHeader[messageType=PUBLISH, isDup=false, qosLevel=AT_MOST_ONCE, isRetain=false, remainingLength=13], variableHeader=MqttPublishVariableHeader[topicName=9090, packetId=-1], payload=PooledSlicedByteBuf(ridx: 7, widx: 7, cap: 7/7, unwrapped: PooledUnsafeDirectByteBuf(ridx: 32, widx: 52, cap: 512))]
2019-12-03 18:29:36.739 [org.springframework.kafka.KafkaListenerEndpointContainer#0-9-C-1] com.zwj.mqtt.cluster.Consumer:32   DEBUG - revice kafka message:{"clientId":"jimmy170503941","retain":false,"dup":false,"topic":"9090","mqttQoS":0,"payload":"aGkgOTA5MQ\u003d\u003d"}
2019-12-03 18:29:36.812 [worker-5-1] c.z.m.s.impl.SessionServiceImpl:36   DEBUG - getSessionByClientId,clientId:jimmy172320146,result:null
2019-12-03 18:29:36.813 [worker-5-1] c.z.m.p.MqttServerPublishProcess:124  DEBUG - Publish - clientId: jimmy172320146, cleanSession: MqttPublishMessage[fixedHeader=MqttFixedHeader[messageType=PUBLISH, isDup=false, qosLevel=AT_MOST_ONCE, isRetain=false, remainingLength=18], variableHeader=MqttPublishVariableHeader[topicName=9090, packetId=-1], payload=PooledSlicedByteBuf(ridx: 12, widx: 12, cap: 12/12, unwrapped: PooledUnsafeDirectByteBuf(ridx: 52, widx: 52, cap: 512))]
2019-12-03 18:29:36.868 [kafka-producer-network-thread | producer-1] com.zwj.mqtt.cluster.Producer$1:30   DEBUG - kafka topic [hubMqttCluster]  message [{"clientId":"jimmy170503941","retain":false,"dup":false,"topic":"9090","mqttQoS":0,"payload":"aGkgOTA5MQ\u003d\u003d"}]  send, resultProducerRecord(topic=hubMqttCluster, partition=null, headers=RecordHeaders(headers = [], isReadOnly = true), key=null, value={"clientId":"jimmy170503941","retain":false,"dup":false,"topic":"9090","mqttQoS":0,"payload":"aGkgOTA5MQ\u003d\u003d"}, timestamp=null)
2019-12-03 18:29:36.890 [worker-5-1] c.z.m.server.MqttServerHandler:88   ERROR - mqtt broker has a cause:{}
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1132)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:347)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:148)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:648)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:583)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:500)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:462)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
2019-12-03 18:29:36.926 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] com.zwj.mqtt.cluster.Consumer:32   DEBUG - revice kafka message:{"clientId":"jimmy170503941","retain":false,"dup":false,"topic":"9090","mqttQoS":0,"payload":"aGkgOTA5MQ\u003d\u003d"}
2019-12-03 18:29:36.933 [kafka-producer-network-thread | producer-1] com.zwj.mqtt.cluster.Producer$1:30   DEBUG - kafka topic [hubMqttCluster]  message [{"clientId":"jimmy170503941","retain":false,"dup":false,"topic":"9090","mqttQoS":0,"payload":"aGkgOTA5c3Nzc3Nz"}]  send, resultProducerRecord(topic=hubMqttCluster, partition=null, headers=RecordHeaders(headers = [], isReadOnly = true), key=null, value={"clientId":"jimmy170503941","retain":false,"dup":false,"topic":"9090","mqttQoS":0,"payload":"aGkgOTA5c3Nzc3Nz"}, timestamp=null)
2019-12-03 18:29:36.939 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] com.zwj.mqtt.cluster.Consumer:32   DEBUG - revice kafka message:{"clientId":"jimmy170503941","retain":false,"dup":false,"topic":"9090","mqttQoS":0,"payload":"aGkgOTA5MQ\u003d\u003d"}
2019-12-03 18:29:37.014 [org.springframework.kafka.KafkaListenerEndpointContainer#0-9-C-1] com.zwj.mqtt.cluster.Consumer:32   DEBUG - revice kafka message:{"clientId":"jimmy170503941","retain":false,"dup":false,"topic":"9090","mqttQoS":0,"payload":"aGkgOTA5c3Nzc3Nz"}
2019-12-03 18:29:37.240 [org.springframework.kafka.KafkaListenerEndpointContainer#0-3-C-1] com.zwj.mqtt.cluster.Consumer:32   DEBUG - revice kafka message:{"clientId":"jimmy170503941","retain":false,"dup":false,"topic":"9090","mqttQoS":0,"payload":"aGkgOTA5MA\u003d\u003d"}
2019-12-03 18:29:37.371 [worker-5-2] c.z.m.s.impl.SessionServiceImpl:47   DEBUG - putSessionByClient,clientId:jimmy172320146,sessionModel:{"brokerId":2,"clientId":"jimmy172320146","channelId":"acde48fffe001122-00000788-00000004-e8fdf9056fe6de45-a2d5799d","cleanSession":true,"willMessage":null},mexpire:{}
2019-12-03 18:29:37.410 [worker-5-2] c.z.m.p.MqttServerConnectProcess:146  DEBUG - CONNECT - clientId: jimmy172320146, connectMsg: MqttConnectMessage[fixedHeader=MqttFixedHeader[messageType=CONNECT, isDup=false, qosLevel=AT_MOST_ONCE, isRetain=false, remainingLength=26], variableHeader=MqttConnectVariableHeader[name=MQTT, version=4, hasUserName=false, hasPassword=false, isWillRetain=false, isWillFlag=false, isCleanSession=true, keepAliveTimeSeconds=60], payload=MqttConnectPayload[clientIdentifier=jimmy172320146, willTopic=null, willMessage=null, userName=null, password=null]],connectAckMsg:MqttConnAckMessage[fixedHeader=MqttFixedHeader[messageType=CONNACK, isDup=false, qosLevel=AT_MOST_ONCE, isRetain=false, remainingLength=0], variableHeader=MqttConnAckVariableHeader[connectReturnCode=CONNECTION_ACCEPTED, sessionPresent=false], payload=]
2019-12-03 18:29:39.506 [org.springframework.kafka.KafkaListenerEndpointContainer#0-9-C-1] c.z.m.p.MqttServerPublishProcess:192  DEBUG - PUBLISH - clientId: jimmy170503941, topic: 9090, Qos: 0
2019-12-03 18:29:39.580 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] com.zwj.mqtt.cluster.Consumer:32   DEBUG - revice kafka message:{"clientId":"jimmy170503941","retain":false,"dup":false,"topic":"9090","mqttQoS":0,"payload":"aGkgOTA5MQ\u003d\u003d"}
2019-12-03 18:29:39.580 [org.springframework.kafka.KafkaListenerEndpointContainer#0-11-C-1] com.zwj.mqtt.cluster.Consumer:32   DEBUG - revice kafka message:{"clientId":"jimmy170503941","retain":false,"dup":false,"topic":"9090","mqttQoS":0,"payload":"aGkgOTA5c3Nzc3Nz"}
2019-12-03 18:29:39.580 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] c.z.m.p.MqttServerPublishProcess:192  DEBUG - PUBLISH - clientId: jimmy170503941, topic: 9090, Qos: 0
2019-12-03 18:29:39.580 [org.springframework.kafka.KafkaListenerEndpointContainer#0-11-C-1] c.z.m.p.MqttServerPublishProcess:192  DEBUG - PUBLISH - clientId: jimmy170503941, topic: 9090, Qos: 0
2019-12-03 18:29:48.988 [worker-5-2] c.z.m.s.impl.SessionServiceImpl:36   DEBUG - getSessionByClientId,clientId:jimmy172320146,result:{"brokerId":2,"clientId":"jimmy172320146","channelId":"acde48fffe001122-00000788-00000004-e8fdf9056fe6de45-a2d5799d","cleanSession":true,"willMessage":null}
2019-12-03 18:29:48.989 [worker-5-2] c.z.m.p.MqttServerPublishProcess:124  DEBUG - Publish - clientId: jimmy172320146, cleanSession: MqttPublishMessage[fixedHeader=MqttFixedHeader[messageType=PUBLISH, isDup=false, qosLevel=AT_MOST_ONCE, isRetain=false, remainingLength=18], variableHeader=MqttPublishVariableHeader[topicName=9090, packetId=-1], payload=PooledSlicedByteBuf(ridx: 12, widx: 12, cap: 12/12, unwrapped: PooledUnsafeDirectByteBuf(ridx: 20, widx: 20, cap: 1024))]
2019-12-03 18:29:49.075 [kafka-producer-network-thread | producer-1] com.zwj.mqtt.cluster.Producer$1:30   DEBUG - kafka topic [hubMqttCluster]  message [{"clientId":"jimmy170503941","retain":false,"dup":false,"topic":"9090","mqttQoS":0,"payload":"aGkgOTA5c3Nzc3Nz"}]  send, resultProducerRecord(topic=hubMqttCluster, partition=null, headers=RecordHeaders(headers = [], isReadOnly = true), key=null, value={"clientId":"jimmy170503941","retain":false,"dup":false,"topic":"9090","mqttQoS":0,"payload":"aGkgOTA5c3Nzc3Nz"}, timestamp=null)
2019-12-03 18:29:49.123 [org.springframework.kafka.KafkaListenerEndpointContainer#0-14-C-1] com.zwj.mqtt.cluster.Consumer:32   DEBUG - revice kafka message:{"clientId":"jimmy170503941","retain":false,"dup":false,"topic":"9090","mqttQoS":0,"payload":"aGkgOTA5c3Nzc3Nz"}
2019-12-03 18:29:49.124 [org.springframework.kafka.KafkaListenerEndpointContainer#0-14-C-1] com.zwj.mqtt.cluster.Consumer:32   DEBUG - revice kafka message:{"clientId":"jimmy170503941","retain":false,"dup":false,"topic":"9090","mqttQoS":0,"payload":"aGkgOTA5c3Nzc3Nz"}
2019-12-03 18:29:49.124 [org.springframework.kafka.KafkaListenerEndpointContainer#0-14-C-1] c.z.m.p.MqttServerPublishProcess:192  DEBUG - PUBLISH - clientId: jimmy170503941, topic: 9090, Qos: 0
2019-12-03 18:29:53.377 [worker-5-2] c.z.m.s.impl.SessionServiceImpl:36   DEBUG - getSessionByClientId,clientId:jimmy172320146,result:{"brokerId":2,"clientId":"jimmy172320146","channelId":"acde48fffe001122-00000788-00000004-e8fdf9056fe6de45-a2d5799d","cleanSession":true,"willMessage":null}
2019-12-03 18:29:53.378 [worker-5-2] c.z.m.p.MqttServerPublishProcess:124  DEBUG - Publish - clientId: jimmy172320146, cleanSession: MqttPublishMessage[fixedHeader=MqttFixedHeader[messageType=PUBLISH, isDup=false, qosLevel=AT_MOST_ONCE, isRetain=false, remainingLength=21], variableHeader=MqttPublishVariableHeader[topicName=9090, packetId=-1], payload=PooledSlicedByteBuf(ridx: 15, widx: 15, cap: 15/15, unwrapped: PooledUnsafeDirectByteBuf(ridx: 23, widx: 23, cap: 512))]
2019-12-03 18:29:53.465 [kafka-producer-network-thread | producer-1] com.zwj.mqtt.cluster.Producer$1:30   DEBUG - kafka topic [hubMqttCluster]  message [{"clientId":"jimmy170503941","retain":false,"dup":false,"topic":"9090","mqttQoS":0,"payload":"aGkgOTA5c3Nzc3Nzc3Nz"}]  send, resultProducerRecord(topic=hubMqttCluster, partition=null, headers=RecordHeaders(headers = [], isReadOnly = true), key=null, value={"clientId":"jimmy170503941","retain":false,"dup":false,"topic":"9090","mqttQoS":0,"payload":"aGkgOTA5c3Nzc3Nzc3Nz"}, timestamp=null)
2019-12-03 18:29:53.526 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] com.zwj.mqtt.cluster.Consumer:32   DEBUG - revice kafka message:{"clientId":"jimmy170503941","retain":false,"dup":false,"topic":"9090","mqttQoS":0,"payload":"aGkgOTA5c3Nzc3Nzc3Nz"}
2019-12-03 18:29:53.527 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] c.z.m.p.MqttServerPublishProcess:192  DEBUG - PUBLISH - clientId: jimmy170503941, topic: 9090, Qos: 0
2019-12-03 18:29:53.561 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] com.zwj.mqtt.cluster.Consumer:32   DEBUG - revice kafka message:{"clientId":"jimmy170503941","retain":false,"dup":false,"topic":"9090","mqttQoS":0,"payload":"aGkgOTA5c3Nzc3Nzc3Nz"}
2019-12-03 18:29:56.880 [worker-5-2] c.z.m.s.impl.SessionServiceImpl:36   DEBUG - getSessionByClientId,clientId:jimmy172320146,result:{"brokerId":2,"clientId":"jimmy172320146","channelId":"acde48fffe001122-00000788-00000004-e8fdf9056fe6de45-a2d5799d","cleanSession":true,"willMessage":null}
2019-12-03 18:29:56.880 [worker-5-2] c.z.m.p.MqttServerPublishProcess:124  DEBUG - Publish - clientId: jimmy172320146, cleanSession: MqttPublishMessage[fixedHeader=MqttFixedHeader[messageType=PUBLISH, isDup=false, qosLevel=AT_MOST_ONCE, isRetain=false, remainingLength=24], variableHeader=MqttPublishVariableHeader[topicName=9090, packetId=-1], payload=PooledSlicedByteBuf(ridx: 18, widx: 18, cap: 18/18, unwrapped: PooledUnsafeDirectByteBuf(ridx: 26, widx: 26, cap: 512))]
2019-12-03 18:29:57.038 [kafka-producer-network-thread | producer-1] com.zwj.mqtt.cluster.Producer$1:30   DEBUG - kafka topic [hubMqttCluster]  message [{"clientId":"jimmy170503941","retain":false,"dup":false,"topic":"9090","mqttQoS":0,"payload":"aGkgOTA5c3Nzc3Nzc3Nzamlh"}]  send, resultProducerRecord(topic=hubMqttCluster, partition=null, headers=RecordHeaders(headers = [], isReadOnly = true), key=null, value={"clientId":"jimmy170503941","retain":false,"dup":false,"topic":"9090","mqttQoS":0,"payload":"aGkgOTA5c3Nzc3Nzc3Nzamlh"}, timestamp=null)
2019-12-03 18:29:57.140 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] com.zwj.mqtt.cluster.Consumer:32   DEBUG - revice kafka message:{"clientId":"jimmy170503941","retain":false,"dup":false,"topic":"9090","mqttQoS":0,"payload":"aGkgOTA5c3Nzc3Nzc3Nzamlh"}
2019-12-03 18:29:57.172 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] com.zwj.mqtt.cluster.Consumer:32   DEBUG - revice kafka message:{"clientId":"jimmy170503941","retain":false,"dup":false,"topic":"9090","mqttQoS":0,"payload":"aGkgOTA5c3Nzc3Nzc3Nzamlh"}
2019-12-03 18:29:57.173 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] c.z.m.p.MqttServerPublishProcess:192  DEBUG - PUBLISH - clientId: jimmy170503941, topic: 9090, Qos: 0
